{"version":3,"sources":["components/Table/Table.component.tsx","App.js","reportWebVitals.js","index.js"],"names":["StyledFileInput","styled","input","StyledLabel","label","StyledTableHead","TableHead","StyledTableCell","TableCell","StyledVerticalDiv","div","StyledTableContainer","StyledTableRow","TableRow","HorizontalDiv","TableExtension","props","useState","tableData","setTableData","col","setColumnSize","useHeader","setHeader","useEffect","init","sdk","window","startAutoResizer","data","field","getValue","updateTableStateAndField","setValue","renderTableRows","start","end","length","styledRows","rowIdx","row","push","renderTableCells","aria-label","icon","onClick","removeSelectedRow","map","item","cellIdx","removeSelectedColumn","name","id","labelText","value","onChange","e","event","newTableData","target","updateCellData","textarea","csvToTable","text","maxCols","split","line","cells","rowIndex","splice","colIndex","forEach","htmlFor","files","reader","FileReader","onload","result","csvText","console","log","readAsText","loadCsv","type","accept","isActive","onToggle","buttonType","size","table","additionalRow","Array","fill","pop","newColSize","newTable","index","row2","concat","newColumnSize","slice","AppContainer","App","className","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.239ded88.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {\n    Icon,\n    Button,\n    TextField,\n    TableBody,\n    TableCell,\n    TableRow,\n    Table,\n    TableHead,\n    ToggleButton,\n    Subheading,\n    IconButton\n} from '@contentful/forma-36-react-components';\nimport '@contentful/forma-36-react-components/dist/styles.css';\nimport styled from \"styled-components\";\nimport { init } from \"@contentful/app-sdk\";\n\nlet primaryButtonColor = 'rgb(46, 117, 212)';\n\nconst StyledFileInput = styled.input`\n        display: none;\n`;\n\nconst StyledLabel = styled.label`\n    color: white;\n    border: 1px solid #ccc;\n    border-radius: 0.25rem;\n    display: inline-block;\n    padding: 6px 12px;\n    cursor: pointer;\n    background-color: ${primaryButtonColor};\n`;\n\n\n// background-color: ${(props: any) => props.headers === 'true' ? \"#798cd4\" : 'white'}\nconst StyledTableHead = styled(TableHead)`\n        th {\n            background-color: #8897cf;\n        }\n`;\n\nconst StyledTableCell = styled(TableCell)`\n        padding 0 2rem;\n        display: flex;\n        align-items: center;\n        justify-content: center; \n        width: 100%\n        height: 100%\n`;\n\nconst StyledVerticalDiv = styled.div`\n    display: flex;\n    flex-direction: column;\n`;\n\nconst StyledTableContainer = styled.div`\n    width: 100%;\n    overflow-x: auto;\n    padding: 1rem;\n    display: flex;\n    flex-direction: row;\n`;\n\nconst StyledTableRow = styled(TableRow)`\n    margin: 0.25rem;\n    display: flex;\n    flex-direction: row;\n`;\n\nconst HorizontalDiv = styled.div`\n    display: flex;\n    // margin: 1rem;\n    flex-direction: horizontal;\n    \n    > * {\n        margin: 0.25rem;\n    }\n`;\n\nconst TableExtension = (props: any) => {\n\n    const [tableData, setTableData] = useState<any[]>([]);\n    const [col, setColumnSize] = useState<number>(3);\n    const [useHeader, setHeader] = useState(true);\n\n    /**\n     * Starts the entension window auto resizing and unpacks saved table data and metadata.\n     */\n    const initializeExtension = () => {\n        init((sdk: any) => {\n            sdk.window.startAutoResizer();\n            let data = sdk.field.getValue();\n            setTableData(data.tableData);\n            setHeader(data.useHeader);\n        });\n    }\n\n    useEffect(() => {\n        initializeExtension();\n    }, [])\n\n    const handleToggleHeader = () => {\n        console.log({ tableData });\n        setHeader(!useHeader);\n        updateTableStateAndField(tableData);\n    }\n\n\n    /** wrapper to ensure table changes synchronize with contentful field value changes. */\n    const updateTableStateAndField = (tableData: any[]) => {\n        // updating react component state\n        setTableData(tableData);\n\n        // // update the field value\n        init((sdk: any) => {\n            sdk.field.setValue({\n                useHeader,\n                tableData\n            });\n        })\n    }\n\n    /**\n     * Adds a row to the table with a size determined by the current column count.\n     */\n    const addRow = () => {\n        if (col <= 0) {\n            return;\n        }\n        let table: any[] = [...tableData];\n        let additionalRow = new Array(col).fill(null);\n        table.push(additionalRow);\n        updateTableStateAndField(table);\n    }\n\n    const addCol = () => {\n        let newColSize = col + 1;\n        setColumnSize(newColSize);\n        // go through all the pre-existing rows and increase their size.\n        let newTable = [...tableData];\n        // console.log({newTable});\n        newTable.forEach((row, index) => {\n            if (row.length < newColSize) {\n                // increase the row size.\n                let row2 = row.concat(new Array(newColSize - row.length).fill(null));\n                newTable[index] = row2;\n            }\n        });\n        // console.table(newTable);\n        updateTableStateAndField(newTable);\n    }\n\n    /**\n     * reduces the column size for the next row to be created\n     */\n    const removeEndCol = () => {\n        if (col <= 0) {\n            return;\n        }\n        let newColumnSize = col - 1;\n        setColumnSize(newColumnSize);\n        // go through all the pre-existing rows and increase their size.\n        let newTable = [...tableData];\n        newTable.forEach((row, index) => {\n            if (row.length > newColumnSize) {\n                console.log('reducing column size');\n                // increase the row size.\n                let row2 = row.slice(0, newColumnSize);\n                newTable[index] = row2;\n            }\n        });\n        updateTableStateAndField(newTable);\n    }\n\n    /**\n     * removes the end/bottom row of the table\n     */\n    const removeRow = () => {\n        if (tableData.length <= 0) {\n            return;\n        }\n        let newTableData = [...tableData];\n        newTableData.pop();\n        updateTableStateAndField(newTableData);\n    }\n\n    /**\n     * Generates the table rows from table data\n     * @param start starting index of the rows you wish to render\n     * @param end index to end rendering rows\n     */\n    const renderTableRows = (start: number | null = null, end: number | null = null) => {\n        if (tableData.length <= 0) {\n            return;\n        }\n        let styledRows = [];\n        // remapping the values to work with for-loop\n        start = start ? start : 0;\n        end = end ? end : tableData.length;\n        for (let rowIdx = start; rowIdx < end; rowIdx++) {\n            let row = tableData[rowIdx];\n            styledRows.push(\n                <>\n                    <StyledTableRow key={\"row\" + rowIdx}>\n                        {renderTableCells(row, rowIdx)}\n                        <StyledTableCell>\n                            <Button aria-label={`Delete row ${rowIdx}`} icon=\"Delete\" onClick={() => removeSelectedRow(rowIdx)}></Button>\n                        </StyledTableCell>\n                    </StyledTableRow>\n                </>\n            )\n        }\n        return styledRows;\n    }\n\n    /**\n     * Updates the table data with values from a table cell.\n     */\n    const updateCellData = (event: any, rowIdx: number, cellIdx: number) => {\n        let newTableData = [...tableData]; // copy the object\n        newTableData[rowIdx][cellIdx] = event.target.value // update the singular cell entry\n        updateTableStateAndField(newTableData); // update the tableData state. (not sure if it's necessary?)\n    }\n\n    /**\n     * Creates the cells of a row within the table\n     * @param row A row which is an array of string values\n     * @param rowIdx The index of the row currently being created\n     */\n    const renderTableCells = (row: string[], rowIdx: number) => {\n        return row.map((item, cellIdx) => {\n            return <TableCell>\n                <StyledVerticalDiv>\n                    {rowIdx === 0 ?\n                        <Button\n                            icon=\"Delete\"\n                            aria-label={`Delete column ${cellIdx}`}\n                            onClick={() => removeSelectedColumn(cellIdx)}>\n                        </Button>\n                        : null\n                    }\n                    <TextField\n                        name={`table-cell-y${rowIdx}-x${cellIdx}`}\n                        id={`table-cell-y${rowIdx}-x${cellIdx}`}\n                        labelText={``}\n                        value={item}\n                        // helpText={`Input your text.`}\n                        aria-label={`Input for row ${rowIdx}, cell ${cellIdx}`}\n                        onChange={e => updateCellData(e, rowIdx, cellIdx)}\n                        textarea\n                    ></TextField>\n                </StyledVerticalDiv>\n            </TableCell>\n        });\n    }\n\n    /**\n     * Loads a csv file into the table component.\n     * @param e event\n     */\n    const loadCsv = (e: any) => {\n        let files = e.target.files;\n        let reader = new FileReader();\n        reader.onload = function (e) {\n            if (e && e.target && e.target.result) {\n                let csvText = e.target.result;\n                console.log(typeof (csvText));\n                if (typeof (csvText) == 'string') {\n                    csvToTable(csvText);\n                }\n            }\n        };\n        reader.readAsText(files[0]);\n    }\n\n    /**\n     * Converts a csv formatted text into a 2D table data array.\n     */\n    const csvToTable = (text: string) => {\n        let maxCols = 0;\n        let lines = text.split('\\n');\n        let newTableData = lines.map((line: string) => {\n            let cells = line.split(',');\n            // update column setting for the table\n            maxCols = maxCols < cells.length ? cells.length : maxCols;\n            return cells;\n        });\n        setColumnSize(maxCols);\n        updateTableStateAndField(newTableData);\n    }\n\n    /**\n     * Determines what table type to create and renders it.\n     */\n    const renderTable = () => {\n        if (useHeader) {\n            return (\n                <>\n                    <StyledTableHead>\n                        {renderTableRows(0, 1)}\n                    </StyledTableHead>\n                    <TableBody>\n                        {renderTableRows(1)}\n                    </TableBody>\n                </>\n            )\n        } else {\n            return (\n                <TableBody>\n                    {renderTableRows()}\n                </TableBody>\n            )\n        }\n    }\n\n    /**\n     * Removes a single row at the index specified\n     */\n    const removeSelectedRow = (rowIndex: number) => {\n        let newTableData = [...tableData];\n        newTableData.splice(rowIndex, 1);\n        updateTableStateAndField(newTableData);\n    }\n\n    const removeSelectedColumn = (colIndex: number) => {\n        let newTableData = [...tableData];\n        newTableData.forEach(row => {\n            row.splice(colIndex, 1);\n        });\n        setColumnSize(col - 1);\n        updateTableStateAndField(newTableData);\n    }\n\n    return (\n        <>\n            <StyledLabel htmlFor=\"csv-file\">\n                Import .csv\n            </StyledLabel>\n            <StyledFileInput id=\"csv-file\" onChange={(e) => loadCsv(e)} type=\"file\" accept=\".csv\"></StyledFileInput>\n            <StyledTableContainer>\n                <Table>\n                    {renderTable()}\n                </Table>\n            </StyledTableContainer>\n            <Subheading>\n                Rows: {tableData.length} Columns: {col}\n            </Subheading>\n            <HorizontalDiv>\n                <ToggleButton isActive={useHeader} onToggle={handleToggleHeader}\n                >Headers</ToggleButton>\n            </HorizontalDiv>\n            <HorizontalDiv>\n                <Button buttonType=\"primary\" size=\"small\" icon=\"Plus\" onClick={addRow} aria-label=\"Add new row\">Row</Button>\n                <Button buttonType=\"primary\" size=\"small\" icon=\"Minus\" onClick={removeRow} aria-label=\"Remove end row\">Row</Button>\n            </HorizontalDiv>\n            <HorizontalDiv>\n                <Button buttonType=\"primary\" size=\"small\" icon=\"Plus\" aria-label=\"Add new column\" onClick={addCol}>Column</Button>\n                <Button buttonType=\"primary\" size=\"small\" icon=\"Minus\" aria-label=\"Remove end column\" onClick={removeEndCol}>Column</Button>\n            </HorizontalDiv>\n        </>\n    )\n}\n\nexport default TableExtension;","import './App.css';\nimport TableExtension from \"./components/Table/Table.component\";\nimport styled from 'styled-components';\n\nconst AppContainer = styled.div`\n  overflow: hidden;\n  border-radius: 10px;\n`;\n\n\nfunction App() {\n    return (\n      <AppContainer className=\"App\">\n        <header className=\"App-header\">\n          <TableExtension></TableExtension>\n        </header>\n      </AppContainer>\n    );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}